[[plugins]]
  package = "netlify-plugin-11ty"
  [plugins.inputs]
    cache_img = 'assets/images'

[build]
  environment = { NODE_VERSION = "16.17.0" }
  command = "echo '//registry.npmjs.org/:_authToken=${NPM_TOKEN}' >> .npmrc && yarn install && yarn build"

# serve 404 simplabs' sitemap
  [[redirects]]
    from = "https://simplabs.com/sitemap.xml"
    to = "/404.html"
    status = 404

# redirect simplabs to Mainmatter
[[redirects]]
  from = "https://simplabs.com/*"
  to = "https://mainmatter.com/:splat"
  force = true

[[redirects]]
  from = "https://www.simplabs.com/*"
  to = "https://mainmatter.com/:splat"
  force = true

[[redirects]]
  from = "https://simplabs.de/*"
  to = "https://mainmatter.com/:splat"
  force = true

[[redirects]]
  from = "https://www.simplabs.de/*"
  to = "https://mainmatter.com/:splat"
  force = true

# redirect old workshop pages
[[redirects]]
  from = "https://elixir-phoenix-workshop.simplabs.com/*"
  to = "https://mainmatter.com/expertise/elixir-phoenix/"
  force = true

[[redirects]]
  from = "https://elixir-phoenix-workshops.simplabs.com/*"
  to = "https://mainmatter.com/expertise/elixir-phoenix/"
  force = true

[[redirects]]
  from = "https://elixir-workshops.simplabs.com/*"
  to = "https://mainmatter.com/expertise/elixir-phoenix/"
  force = true

[[redirects]]
  from = "https://phoenix-workshops.simplabs.com/*"
  to = "https://mainmatter.com/expertise/elixir-phoenix/"
  force = true

[[redirects]]
  from = "https://ember-basics-workshop.simplabs.com/*"
  to = "https://mainmatter.com/services/workshops/hands-on-ember/"
  force = true

[[redirects]]
  from = "https://ember-pro-workshop.simplabs.com/*"
  to = "https://mainmatter.com/services/workshops/hands-on-ember/"
  force = true

[[redirects]]
  from = "https://ember-workshop.simplabs.com/*"
  to = "https://mainmatter.com/services/workshops/hands-on-ember/"
  force = true

[[redirects]]
  from = "https://ember-workshops.simplabs.com/*"
  to = "https://mainmatter.com/services/workshops/hands-on-ember/"
  force = true

[[redirects]]
  from = "https://git-workshop.simplabs.com/*"
  to = "https://mainmatter.com/services/workshops/effective-git/"
  force = true

# redirect old simplabs.com URLs
[[redirects]]
  from = "/resources/workshop/digital-product-strategy"
  to = "/services/workshops/digital-product-strategy/"

[[redirects]]
  from = "/resources/workshop/digital-product-strategy"
  to = "/services/workshops/digital-product-strategy/"

[[redirects]]
  from = "/resources/workshop/design-system-kickoff-interface-inventory"
  to = "/services/workshops/design-system-kickoff-interface-inventory/"

[[redirects]]
  from = "/resources/workshop/hands-on-ember"
  to = "/services/workshops/hands-on-ember/"

[[redirects]]
  from = "/resources/workshop/effective-git"
  to = "/services/workshops/hands-on-ember/"

[[redirects]]
  from = "/resources"
  to = "/playbook/"

[[redirects]]
  from = "/calendar"
  to = "/events/"

[[redirects]]
  from = "/talks"
  to = "/events/"

[[redirects]]
  from = "/services"
  to = "/"

[[redirects]]
  from = "/services/digital-products"
  to = "/services/digital-products-and-design/"

[[redirects]]
  from = "/services/product-development"
  to = "/services/digital-products-and-design/"

[[redirects]]
  from = "/services/product-design"
  to = "/services/digital-products-and-design/"

[[redirects]]
  from = "/services/team-augmentation"
  to = "/services/team-augmentation-and-training/"

[[redirects]]
  from = "/services/training"
  to = "/services/team-augmentation-and-training/"

[[redirects]]
  from = "/why-simplabs"
  to = "/"

# redirect old "Web-based Services in Rust" landing page to regular workshop
[[redirects]]
  from = "https://rust-web-services-workshop.mainmatter.com/*"
  to = "https://mainmatter.com/services/workshops/web-based-services-in-rust/"
  force = true

# serve "Svelte & SvelteKit" landing page for svelte-sveltekit-workshop.mainmatter.com
[[redirects]]
  from = "https://svelte-sveltekit-workshop.mainmatter.com/"
  to = "https://mainmatter.com/svelte-sveltekit-workshop/"
  force = true
  status = 200

# serve "Telemetry for Rust applications" landing page for rust-telemetry-workshop.mainmatter.com
[[redirects]]
  from = "https://rust-telemetry-workshop.mainmatter.com/"
  to = "https://mainmatter.com/rust-application-telemetry-workshop/"
  force = true
  status = 200

# serve 404 for all paths that don't exist
[[redirects]]
  from = "/*"
  to = "/404/index.html"
  status = 404
